{"version":3,"file":"dynamic.js","sources":["pages/add/dynamic.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYWRkL2R5bmFtaWMudnVl"],"sourcesContent":["<template>\n  <view class=\"page-container\">\n    <!-- 头部标题 -->\n    <view class=\"page-header\">\n      <text class=\"header-title\">发布动态</text>\n    </view>\n\n    <!-- 表单容器 -->\n    <view class=\"form-container\">\n      <!-- 标题输入 -->\n      <view class=\"form-item\">\n        <text class=\"item-label\">标题</text>\n        <input \n          type=\"text\" \n          v-model=\"post.title\" \n          class=\"input-field\"\n          placeholder=\"请输入吸引人的标题...\"\n          placeholder-class=\"placeholder-style\"\n        />\n      </view>\n\n      <!-- 内容输入 -->\n      <view class=\"form-item content-item\">\n        <text class=\"item-label\">内容</text>\n        <textarea \n          v-model=\"post.content\" \n          class=\"textarea-field\"\n          placeholder=\"分享你的精彩内容...\"\n          placeholder-class=\"placeholder-style\"\n          auto-height\n        />\n      </view>\n\n      <!-- 图片上传 -->\n      <view class=\"form-item\">\n        <text class=\"item-label\">图片</text>\n        <view class=\"upload-container\">\n          <view \n            v-for=\"(image, index) in images\" \n            :key=\"index\" \n            class=\"image-preview\"\n          >\n            <image :src=\"image\" class=\"preview-image\" mode=\"aspectFill\" />\n            <view class=\"delete-icon\" @click=\"removeImage(index)\">×</view>\n          </view>\n          <view \n            class=\"upload-btn\" \n            @click=\"chooseImage\"\n            v-if=\"images.length < 9\"\n          >\n            <text class=\"plus-icon\">+</text>\n            <text class=\"upload-text\">添加图片</text>\n          </view>\n        </view>\n        <text class=\"upload-tip\">最多可上传9张图片</text>\n      </view>\n</view>\n    <!-- 发布按钮 -->\n    <view class=\"submit-btn\" @click=\"publishPost\">\n      <text class=\"btn-text\">{{ isSubmitting ? '发布中...' : '立即发布' }}</text>\n    </view>\n  </view>\r\n  <br>\r\n  <br>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      images: [],\n      isSubmitting: false,\n      post: {\n        title: '',\n        content: '',\n      },\n    };\n  },\n  methods: {\n    async chooseImage() {\n      const remaining = 9 - this.images.length;\n      uni.chooseImage({\n        count: remaining,\n        sizeType: ['compressed'],\n        sourceType: ['album'],\n        success: (res) => {\n          this.images = [...this.images, ...res.tempFilePaths];\n        }\n      });\n    },\n    removeImage(index) {\n      this.images.splice(index, 1);\n    },\n    categoryChange(e) {\n      this.selectedCategoryIndex = e.detail.value;\n    },\n    async publishPost() {\n      if (this.isSubmitting) return;\n      \n      // 表单验证\n      if (!this.post.title.trim()) {\n        return uni.showToast({ title: '请填写标题', icon: 'none' });\n      }\n      if (!this.post.content.trim()) {\n        return uni.showToast({ title: '请填写内容', icon: 'none' });\n      }\n\n      this.isSubmitting = true;\n      \n      try {\n        const res = await this.$myRequest({\n          method: 'post',\n          url: '/fatie',\n          data: {\n            ...this.post,\n            images: this.images.join(','),\n            userId: this.$store.state.user.id,\n            communityId: this.$store.state.communityId\n          }\n        });\n\n        uni.showToast({ title: '发布成功', icon: 'success' });\n        setTimeout(() => uni.navigateBack(), 1500);\n      } catch (error) {\n        console.error('发布失败:', error);\n      } finally {\n        this.isSubmitting = false;\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.page-container {\n  padding: 20rpx 30rpx;\n  background: #f8f9fa;\n  min-height: 100vh;\n}\n\n.page-header {\n  padding: 40rpx 0;\n  .header-title {\n    font-size: 36rpx;\n    font-weight: bold;\n    color: #333;\n  }\n}\n\n.form-container {\n  background: white;\n  border-radius: 16rpx;\n  padding: 30rpx;\n  box-shadow: 0 4rpx 12rpx rgba(0,0,0,0.05);\n}\n\n.form-item {\n  margin-bottom: 40rpx;\n  .item-label {\n    display: block;\n    font-size: 30rpx;\n    color: #333;\n    margin-bottom: 20rpx;\n    font-weight: 500;\n  }\n}\n\n.input-field, .textarea-field {\n  width: 600rpx;\n  padding: 20rpx;\n  border: 2rpx solid #e9ecef;\n  border-radius: 8rpx;\n  font-size: 28rpx;\n  color: #333;\n  &.textarea-field {\n    height: 200rpx;\n  }\n}\n\n.placeholder-style {\n  color: #adb5bd;\n  font-size: 28rpx;\n}\n\n.upload-container {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 10rpx;\n}\n\n.image-preview {\n  width: 200rpx;\n  height: 200rpx;\n  border-radius: 8rpx;\n  overflow: hidden;\n  position: relative;\n  .preview-image {\n    width: 100%;\n    height: 100%;\n  }\n  .delete-icon {\n    position: absolute;\n    right: 10rpx;\n    top: 10rpx;\n    width: 36rpx;\n    height: 36rpx;\n    background: rgba(0,0,0,0.5);\n    color: white;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 24rpx;\n  }\n}\n\n.upload-btn {\n  width: 200rpx;\n  height: 200rpx;\n  border: 2rpx dashed #e9ecef;\n  border-radius: 8rpx;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  .plus-icon {\n    font-size: 48rpx;\n    color: #666;\n  }\n  .upload-text {\n    font-size: 24rpx;\n    color: #666;\n    margin-top: 10rpx;\n  }\n}\n\n.upload-tip {\n  font-size: 24rpx;\n  color: #999;\n  display: block;\n  margin-top: 20rpx;\n}\n\n.category-picker {\n  .picker-content {\n    padding: 20rpx;\n    border: 2rpx solid #e9ecef;\n    border-radius: 8rpx;\n    font-size: 28rpx;\n    color: #333;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    .arrow-icon {\n      color: #666;\n      font-size: 24rpx;\n      margin-left: 20rpx;\n    }\n  }\n}\n\n.submit-btn {\n  margin: 40rpx 0;\n  background: #007aff;\n  border-radius: 50rpx;\n  padding: 25rpx 0;\n  text-align: center;\r\n  position: fixed;\r\n  width: 80%;\r\n  bottom: 0;\r\n  left: 10%;\r\n  box-shadow: 0 0 10rpx rgba(0, 0, 0, 0.1);\r\n  z-index: 9;\n  .btn-text {\n    color: white;\n    font-size: 32rpx;\n    font-weight: 500;\n  }\n  &:active {\n    opacity: 0.9;\n  }\n}\n</style>","import MiniProgramPage from 'E:/program/FrontEnd/uni/uyub/pages/add/dynamic.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AAmEA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,QAAQ,CAAE;AAAA,MACV,cAAc;AAAA,MACd,MAAM;AAAA,QACJ,OAAO;AAAA,QACP,SAAS;AAAA,MACV;AAAA;EAEJ;AAAA,EACD,SAAS;AAAA,IACP,MAAM,cAAc;AAClB,YAAM,YAAY,IAAI,KAAK,OAAO;AAClCA,oBAAAA,MAAI,YAAY;AAAA,QACd,OAAO;AAAA,QACP,UAAU,CAAC,YAAY;AAAA,QACvB,YAAY,CAAC,OAAO;AAAA,QACpB,SAAS,CAAC,QAAQ;AAChB,eAAK,SAAS,CAAC,GAAG,KAAK,QAAQ,GAAG,IAAI,aAAa;AAAA,QACrD;AAAA,MACF,CAAC;AAAA,IACF;AAAA,IACD,YAAY,OAAO;AACjB,WAAK,OAAO,OAAO,OAAO,CAAC;AAAA,IAC5B;AAAA,IACD,eAAe,GAAG;AAChB,WAAK,wBAAwB,EAAE,OAAO;AAAA,IACvC;AAAA,IACD,MAAM,cAAc;AAClB,UAAI,KAAK;AAAc;AAGvB,UAAI,CAAC,KAAK,KAAK,MAAM,KAAI,GAAI;AAC3B,eAAOA,cAAAA,MAAI,UAAU,EAAE,OAAO,SAAS,MAAM,OAAO,CAAC;AAAA,MACvD;AACA,UAAI,CAAC,KAAK,KAAK,QAAQ,KAAI,GAAI;AAC7B,eAAOA,cAAAA,MAAI,UAAU,EAAE,OAAO,SAAS,MAAM,OAAO,CAAC;AAAA,MACvD;AAEA,WAAK,eAAe;AAEpB,UAAI;AACF,cAAM,MAAM,MAAM,KAAK,WAAW;AAAA,UAChC,QAAQ;AAAA,UACR,KAAK;AAAA,UACL,MAAM;AAAA,YACJ,GAAG,KAAK;AAAA,YACR,QAAQ,KAAK,OAAO,KAAK,GAAG;AAAA,YAC5B,QAAQ,KAAK,OAAO,MAAM,KAAK;AAAA,YAC/B,aAAa,KAAK,OAAO,MAAM;AAAA,UACjC;AAAA,QACF,CAAC;AAEDA,sBAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,UAAQ,CAAG;AAChD,mBAAW,MAAMA,cAAG,MAAC,aAAc,GAAE,IAAI;AAAA,MACzC,SAAO,OAAO;AACdA,sBAAc,MAAA,MAAA,SAAA,gCAAA,SAAS,KAAK;AAAA,MAC9B,UAAU;AACR,aAAK,eAAe;AAAA,MACtB;AAAA,IACF;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;ACjIA,GAAG,WAAW,eAAe;"}