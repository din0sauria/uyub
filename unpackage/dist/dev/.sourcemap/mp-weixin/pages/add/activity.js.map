{"version":3,"file":"activity.js","sources":["pages/add/activity.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYWRkL2FjdGl2aXR5LnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"page-container\">\r\n    <!-- 头部标题 -->\r\n    <view class=\"page-header\">\r\n      <text class=\"header-title\">发布活动</text>\r\n    </view>\r\n\r\n    <!-- 表单容器 -->\r\n    <view class=\"form-container\">\r\n      <!-- 活动标题 -->\r\n      <view class=\"form-item\">\r\n        <text class=\"item-label\">活动标题</text>\r\n        <input v-model=\"activity.title\" class=\"input-field\" placeholder=\"请输入活动名称\"\r\n          placeholder-class=\"placeholder-style\" />\r\n      </view>\r\n\r\n      <!-- 活动费用 -->\r\n      <view class=\"form-item\">\r\n        <text class=\"item-label\">活动费用（元）</text>\r\n        <input v-model=\"activity.price\" class=\"input-field\" placeholder=\"请输入人均费用\" placeholder-class=\"placeholder-style\"\r\n          type=\"number\"  @input=\"valiInt\"/>\r\n      </view>\r\n\r\n      <!-- 地址选择 -->\r\n      <view class=\"form-item address-group\">\r\n        <view class=\"address-item\">\r\n          <text class=\"item-label\">所在场馆</text>\r\n          <input v-model=\"activity.address\" class=\"input-field\" placeholder=\"场馆名称\"\r\n            placeholder-class=\"placeholder-style\" />\r\n        </view>\r\n        <view class=\"address-item\">\r\n          <text class=\"item-label\">详细地址</text>\r\n          <input v-model=\"activity.detailAddress\" class=\"input-field\" placeholder=\"街道门牌信息\"\r\n            placeholder-class=\"placeholder-style\" />\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 时间选择 -->\r\n      <view class=\"form-item time-picker\">\r\n        <text class=\"item-label\">活动时间</text>\r\n        <!-- 日期选择 -->\r\n        <view class=\"date-picker\">\r\n          <uni-datetime-picker type=\"date\" v-model=\"activity.date\" :clear-icon=\"false\" @change=\"setDate\">\r\n          </uni-datetime-picker>\r\n        </view>\r\n        <view class=\"time-container\">\r\n          <picker mode=\"time\" @change=\"setStartTime\" class=\"time-item\">\r\n            <view class=\"picker-content\">\r\n              {{ activity.startTime || '开始时间' }}\r\n            </view>\r\n          </picker>\r\n          <text class=\"time-separator\">-</text>\r\n          <picker mode=\"time\" @change=\"setEndTime\" class=\"time-item\">\r\n            <view class=\"picker-content\">\r\n              {{ activity.endTime || '结束时间' }}\r\n            </view>\r\n          </picker>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 人数设置 -->\r\n      <view class=\"form-item number-group\">\r\n        <view class=\"number-item\">\r\n          <text class=\"item-label\">计划人数</text>\r\n          <input v-model=\"activity.plan\" class=\"input-field\" type=\"number\" placeholder=\"总招募人数\"\r\n            placeholder-class=\"placeholder-style\" @input=\"valiInt\" />\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 活动标签 -->\r\n      <view class=\"form-item\">\r\n        <text class=\"item-label\">活动类型</text>\r\n        <picker mode=\"selector\" :range=\"Options\" @change=\"setOption\" class=\"tag-picker\">\r\n          <view class=\"picker-content\">\r\n            {{ activity.option || '选择活动类型' }}\r\n            <text class=\"arrow-icon\">▼</text>\r\n          </view>\r\n        </picker>\r\n      </view>\r\n      <view class=\"form-item\">\r\n        <text class=\"item-label\">活动水平</text>\r\n        <picker mode=\"selector\" :range=\"Tags\" @change=\"setTag\" class=\"tag-picker\">\r\n          <view class=\"picker-content\">\r\n            {{ activity.tag || '选择活动水平' }}\r\n            <text class=\"arrow-icon\">▼</text>\r\n          </view>\r\n        </picker>\r\n      </view>\r\n\r\n      <!-- 活动详情 -->\r\n      <view class=\"form-item\">\r\n        <text class=\"item-label\">活动详情</text>\r\n        <textarea v-model=\"activity.description\" class=\"textarea-field\" placeholder=\"请输入活动详细说明...\"\r\n          placeholder-class=\"placeholder-style\" auto-height />\r\n      </view>\r\n\r\n      <!-- 图片上传 -->\r\n      <view class=\"form-item\">\r\n        <text class=\"item-label\">活动图片</text>\r\n        <view class=\"upload-container\">\r\n          <view v-for=\"(image, index) in images\" :key=\"index\" class=\"image-preview\">\r\n            <image :src=\"image\" class=\"preview-image\" mode=\"aspectFill\" />\r\n            <view class=\"delete-icon\" @click=\"removeImage(index)\">×</view>\r\n          </view>\r\n          <view class=\"upload-btn\" @click=\"chooseImage\" v-if=\"images.length < 9\">\r\n            <text class=\"plus-icon\">+</text>\r\n            <text class=\"upload-text\">添加图片</text>\r\n          </view>\r\n        </view>\r\n        <text class=\"upload-tip\">建议上传活动场地实拍图（最多9张）</text>\r\n      </view>\r\n    </view>\r\n    <br>\r\n    <br>\r\n\r\n    <!-- 发布按钮 -->\r\n    <view class=\"submit-btn\" @click=\"publishActivity\">\r\n      <text class=\"btn-text\">{{ isSubmitting ? '提交中...' : '立即发布' }}</text>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    data() {\r\n      return {\r\n        images: [],\r\n        isSubmitting: false,\r\n        Options: ['羽毛球', '游戏', '乒乓球', '其他'],\r\n        Tags:['不限','萌新','中级','高级'],\r\n        activity: {\r\n          title: '',\r\n          price: '',\r\n          address: '',\r\n          detailAddress: '',\r\n          date: '',\r\n          startTime: '',\r\n          endTime: '',\r\n          participants: '',\r\n          plan: '',\r\n          tag: '',\r\n          option:'',\r\n          description: '',\r\n          images: []\r\n        }\r\n      };\r\n    },\r\n    methods: {\r\n      chooseImage() {\r\n        uni.chooseImage({\r\n          count: 9 - this.images.length,\r\n          sizeType: ['compressed'],\r\n          sourceType: ['album'],\r\n          success: (res) => {\r\n            this.images = [...this.images, ...res.tempFilePaths];\r\n          }\r\n        });\r\n      },\r\n      removeImage(index) {\r\n        this.images.splice(index, 1);\r\n      },\r\n      setDate(e) {\r\n        this.activity.date = e;\r\n      },\r\n      setStartTime(e) {\r\n        this.activity.startTime = e.detail.value;\r\n        this.validateTime();\r\n      },\r\n      setEndTime(e) {\r\n        this.activity.endTime = e.detail.value;\r\n        this.validateTime();\r\n      },\r\n      setTag(e){\r\n        this.activity.tag = this.Tags[e.detail.value];\r\n      },\r\n      validateTime() {\r\n        if (this.activity.startTime && this.activity.endTime) {\r\n          const start = new Date(`1970-01-01T${this.activity.startTime}`);\r\n          const end = new Date(`1970-01-01T${this.activity.endTime}`);\r\n          if (start >= end) {\r\n            uni.showToast({\r\n              title: '结束时间必须晚于开始时间',\r\n              icon: 'none'\r\n            });\r\n            this.activity.endTime = '';\r\n          }\r\n        }\r\n      },\r\n      setOption(e) {\r\n        this.activity.option = this.Options[e.detail.value];\r\n      },\r\n      async publishActivity() {\r\n        if (this.isSubmitting) return;\r\n\r\n        // 表单验证\r\n        const requiredFields = [{\r\n            field: 'title',\r\n            message: '请填写活动标题'\r\n          },\r\n          {\r\n            field: 'price',\r\n            message: '请填写活动费用'\r\n          },\r\n          {\r\n            field: 'address',\r\n            message: '请选择所在场馆'\r\n          },\r\n          {\r\n            field: 'detailAddress',\r\n            message: '请填写详细地址'\r\n          },\r\n          {\r\n            field: 'date',\r\n            message: '请选择日期'\r\n          },\r\n          {\r\n            field: 'startTime',\r\n            message: '请选择开始时间'\r\n          },\r\n          {\r\n            field: 'endTime',\r\n            message: '请选择结束时间'\r\n          },\r\n          {\r\n            field: 'plan',\r\n            message: '请填写计划人数'\r\n          }\r\n        ];\r\n\r\n        for (const {\r\n            field,\r\n            message\r\n          }\r\n          of requiredFields) {\r\n          if (!this.activity[field]) {\r\n            return uni.showToast({\r\n              title: message,\r\n              icon: 'none'\r\n            });\r\n          }\r\n        }\r\n\r\n        this.isSubmitting = true;\r\n\r\n        try {\r\n          const res = await new Promise((resolve, reject) => {\r\n            uni.request({\r\n              method: 'POST',\r\n              url: '/activities', // 替换为你的实际接口地址\r\n              data: {\r\n                ...this.activity,\r\n                images: this.images\r\n              },\r\n              success: (res) => {\r\n                if (res.statusCode === 200) {\r\n                  resolve(res.data);\r\n                } else {\r\n                  reject(res);\r\n                }\r\n              },\r\n              fail: (error) => {\r\n                reject(error);\r\n              }\r\n            });\r\n          });\r\n        \r\n          uni.showToast({\r\n            title: '发布成功',\r\n            icon: 'success'\r\n          });\r\n          setTimeout(() => uni.navigateBack(), 1500);\r\n          console.log('发布成功:', res);\r\n        } catch (error) {\r\n          console.error('发布失败:', error);\r\n        } finally {\r\n          this.isSubmitting = false;\r\n        }\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  .page-container {\r\n    padding: 20rpx 30rpx;\r\n    background: #f8f9fa;\r\n    min-height: 100vh;\r\n  }\r\n\r\n  .page-header {\r\n    padding: 40rpx 0;\r\n\r\n    .header-title {\r\n      font-size: 36rpx;\r\n      font-weight: bold;\r\n      color: #333;\r\n    }\r\n  }\r\n\r\n  .form-container {\r\n    background: white;\r\n    border-radius: 16rpx;\r\n    padding: 30rpx;\r\n    box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.05);\r\n  }\r\n\r\n  .form-item {\r\n    margin-bottom: 40rpx;\r\n\r\n    .item-label {\r\n      display: block;\r\n      font-size: 30rpx;\r\n      color: #333;\r\n      margin-bottom: 20rpx;\r\n      font-weight: 500;\r\n    }\r\n  }\r\n\r\n  .input-field,\r\n  .textarea-field {\r\n    width: 600rpx;\r\n    padding: 20rpx;\r\n    border: 2rpx solid #e9ecef;\r\n    border-radius: 8rpx;\r\n    font-size: 28rpx;\r\n    color: #333;\r\n\r\n    &.textarea-field {\r\n      height: 200rpx;\r\n    }\r\n  }\r\n\r\n  .placeholder-style {\r\n    color: #adb5bd;\r\n    font-size: 28rpx;\r\n  }\r\n\r\n  .upload-container {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 20rpx;\r\n  }\r\n\r\n  .image-preview {\r\n    width: 200rpx;\r\n    height: 200rpx;\r\n    border-radius: 8rpx;\r\n    overflow: hidden;\r\n    position: relative;\r\n\r\n    .preview-image {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n\r\n    .delete-icon {\r\n      position: absolute;\r\n      right: 10rpx;\r\n      top: 10rpx;\r\n      width: 36rpx;\r\n      height: 36rpx;\r\n      background: rgba(0, 0, 0, 0.5);\r\n      color: white;\r\n      border-radius: 50%;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      font-size: 24rpx;\r\n    }\r\n  }\r\n\r\n  .upload-btn {\r\n    width: 200rpx;\r\n    height: 200rpx;\r\n    border: 2rpx dashed #e9ecef;\r\n    border-radius: 8rpx;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n\r\n    .plus-icon {\r\n      font-size: 48rpx;\r\n      color: #666;\r\n    }\r\n\r\n    .upload-text {\r\n      font-size: 24rpx;\r\n      color: #666;\r\n      margin-top: 10rpx;\r\n    }\r\n  }\r\n\r\n  .upload-tip {\r\n    font-size: 24rpx;\r\n    color: #999;\r\n    display: block;\r\n    margin-top: 20rpx;\r\n  }\r\n\r\n  .category-picker {\r\n    .picker-content {\r\n      padding: 20rpx;\r\n      border: 2rpx solid #e9ecef;\r\n      border-radius: 8rpx;\r\n      font-size: 28rpx;\r\n      color: #333;\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n\r\n      .arrow-icon {\r\n        color: #666;\r\n        font-size: 24rpx;\r\n        margin-left: 20rpx;\r\n      }\r\n    }\r\n  }\r\n\r\n  .submit-btn {\r\n    margin: 40rpx 0;\r\n    background: #007aff;\r\n    border-radius: 50rpx;\r\n    padding: 25rpx 0;\r\n    text-align: center;\r\n    position: fixed;\r\n    width: 80%;\r\n    bottom: 0;\r\n    left: 10%;\r\n    box-shadow: 0 0 10rpx rgba(0, 0, 0, 0.1);\r\n    z-index: 9;\r\n\r\n    .btn-text {\r\n      color: white;\r\n      font-size: 32rpx;\r\n      font-weight: 500;\r\n    }\r\n\r\n    &:active {\r\n      opacity: 0.9;\r\n    }\r\n  }\r\n\r\n  /* 新增特色样式 */\r\n  .address-group {\r\n    .address-item {\r\n      margin-bottom: 30rpx;\r\n\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n  }\r\n\r\n  .time-picker {\r\n    .date-picker {\r\n      margin-bottom: 30rpx;\r\n\r\n      .picker-content {\r\n        padding: 20rpx;\r\n        border: 2rpx solid #e9ecef;\r\n        border-radius: 8rpx;\r\n        color: #333;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-between;\r\n      }\r\n    }\r\n\r\n    .time-container {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 20rpx;\r\n\r\n      .time-item {\r\n        flex: 1;\r\n\r\n        .picker-content {\r\n          padding: 10rpx;\r\n          border: 2rpx solid #e9ecef;\r\n          border-radius: 8rpx;\r\n          text-align: center;\r\n          color: #333;\r\n        }\r\n      }\r\n\r\n      .time-separator {\r\n        color: #666;\r\n        font-size: 28rpx;\r\n      }\r\n    }\r\n  }\r\n\r\n  .number-group {\r\n    display: flex;\r\n    gap: 30rpx;\r\n\r\n    .number-item {\r\n      flex: 1;\r\n    }\r\n  }\r\n\r\n  .tag-picker {\r\n    .picker-content {\r\n      padding: 20rpx;\r\n      border: 2rpx solid #e9ecef;\r\n      border-radius: 8rpx;\r\n      color: #333;\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n    }\r\n  }\r\n\r\n  .textarea-field {\r\n    min-height: 200rpx;\r\n    padding: 20rpx;\r\n    line-height: 1.6;\r\n  }\r\n</style>","import MiniProgramPage from 'E:/program/FrontEnd/uni/uyub/pages/add/activity.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","res"],"mappings":"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"}